<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Ultimate AI Trading Bot</title>
<style>
body{background:#020617;color:white;font-family:Arial;text-align:center}
select,button,input{padding:7px;margin:4px;border-radius:8px;border:none}
canvas{background:#020617;border:1px solid #334155;margin-top:8px}
.green{color:#22c55e}
.red{color:#ef4444}
</style>
</head>
<body>

<h2>ULTIMATE AI TRADING BOT</h2>

Pair
<select id="symbol">
<option>BTCUSDT</option>
<option>ETHUSDT</option>
<option>SOLUSDT</option>
<option>BNBUSDT</option>
</select>

TF
<select id="tf">
<option value="1m">1m</option>
<option value="5m">5m</option>
<option value="15m">15m</option>
<option value="1h">1h</option>
</select>

Risk %
<input type="range" min="1" max="10" value="2" id="risk">

<button onclick="start()">START</button>
<button onclick="stop()">STOP</button>

<div id="panel"></div>

<canvas id="chart" width="900" height="300"></canvas>
<canvas id="equity" width="900" height="150"></canvas>

<script>
let run=false
let balance=10000
let pos=null
let wins=0,loss=0
let equity=[balance]

//---------------- EMA
function ema(a,p){
let k=2/(p+1),e=a[0]
for(let i=1;i<a.length;i++) e=a[i]*k+e*(1-k)
return e
}

//---------------- FETCH
async function candles(){
let r=await fetch(`https://api.binance.com/api/v3/klines?symbol=${symbol.value}&interval=${tf.value}&limit=200`)
return await r.json()
}

//---------------- TREND REGIME
function regime(c){
let e50=ema(c.slice(-60),50)
let e200=ema(c,200)
if(Math.abs(e50-e200)<c.at(-1)*0.002) return "RANGE"
return e50>e200?"TREND UP":"TREND DOWN"
}

//---------------- LIQUIDITY SWEEP
function sweep(c){
let h=Math.max(...c.slice(-20))
let l=Math.min(...c.slice(-20))
let p=c.at(-1)
if(p>h) return "BUY SWEEP"
if(p<l) return "SELL SWEEP"
return null
}

//---------------- VOLUME WHALE
function whale(v){
let avg=v.slice(-20).reduce((a,b)=>a+b)/20
return v.at(-1)>avg*2
}

//---------------- STRUCTURE
function structure(c){
let l=c.length
if(c[l-4]>c[l-3]&&c[l-1]>c[l-2])return"buy"
if(c[l-4]<c[l-3]&&c[l-1]<c[l-2])return"sell"
return null
}

//---------------- AI PREDICTOR
function aiScore(c){
let momentum=c.at(-1)-c.at(-5)
let volatility=Math.max(...c.slice(-20))-Math.min(...c.slice(-20))
return (momentum/volatility)*100
}

//---------------- DRAW PRICE
function draw(data){
let ctx=chart.getContext("2d")
ctx.clearRect(0,0,900,300)
let max=Math.max(...data)
let min=Math.min(...data)
data.forEach((v,i)=>{
let x=i*(900/data.length)
let y=300-(v-min)/(max-min)*300
ctx.fillRect(x,y,2,2)
})
}

//---------------- EQUITY GRAPH
function drawEq(){
let ctx=equityCanvas.getContext("2d")
ctx.clearRect(0,0,900,150)
let max=Math.max(...equity)
let min=Math.min(...equity)
equity.forEach((v,i)=>{
let x=i*(900/equity.length)
let y=150-(v-min)/(max-min)*150
ctx.fillRect(x,y,2,2)
})
}

//---------------- LOOP
async function loop(){
if(!run)return

let raw=await candles()
let closes=raw.map(x=>+x[4])
let vols=raw.map(x=>+x[5])
let price=closes.at(-1)

draw(closes)

let reg=regime(closes)
let str=structure(closes)
let sw=sweep(closes)
let whaleSig=whale(vols)
let ai=aiScore(closes)

let strength=Math.abs(ai).toFixed(1)

panel.innerHTML=
`Balance ${balance.toFixed(2)} |
WinRate ${wins+loss?((wins/(wins+loss))*100).toFixed(1):0}% |
Regime ${reg} |
AI ${strength}% |
${whaleSig?"ðŸ‹ Whale Activity":""}`

//------ adaptive risk
let riskPct=risk.value/100
if(reg=="RANGE") riskPct/=2
if(whaleSig) riskPct*=1.5
let size=(balance*riskPct)/price

//------ entry
if(!pos){
if(ai>10&&str=="buy") pos={t:"BUY",e:price,s:size}
if(ai<-10&&str=="sell") pos={t:"SELL",e:price,s:size}
}

//------ exit
else{
let pnl=(price-pos.e)*(pos.t=="BUY"?1:-1)*pos.s

let tp=Math.abs(ai)*2
let sl=tp/2

if(pnl>tp||pnl<-sl){
balance+=pnl
equity.push(balance)
drawEq()
pnl>0?wins++:loss++
pos=null
}
}

setTimeout(loop,2500)
}

//---------------- CONTROL
function start(){run=true;loop()}
function stop(){run=false}

let chart=document.getElementById("chart")
let equityCanvas=document.getElementById("equity")
let symbol=document.getElementById("symbol")
let tf=document.getElementById("tf")
let panel=document.getElementById("panel")
</script>
</body>
</html>